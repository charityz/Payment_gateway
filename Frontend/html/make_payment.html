<!-- <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Make Payment</title>
  </head>
  <body class="bg-gray-100 flex items-center justify-center min-h-screen">
    <div
      class="bg-white shadow-lg rounded-2xl flex w-full max-w-4xl overflow-hidden"
    >
      Payment Options (Left Side)
      <div class="flex flex-col items-start p-4 space-y-4 bg-gray-50">
        <button
          id="tab-card"
          class="flex items-center space-x-2 bg-green-500 text-white px-4 py-2 rounded-lg shadow cursor-pointer"
        >
          <span>üí≥</span>
        </button>
        <button
          id="tab-transfer"
          class="flex items-center space-x-2 bg-gray-200 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-300 cursor-pointer"
        >
          <span>üè¶</span>
        </button>
        <button
          id="tab-wallet"
          class="flex items-center space-x-2 bg-gray-200 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-300 cursor-pointer"
        >
          <span>üëõ</span>
        </button>
      </div>

      Payment Form
      <div class="flex-1 p-8">
        <h2 class="text-2xl font-bold mb-6">Complete Your Payment</h2>

        Email & Amount
        <div class="mb-4">
          <label class="block text-gray-600 mb-1">Email</label>
          <input
            id="email"
            type="email"
            value="user@example.com"
            readonly
            class="w-full px-4 py-2 border rounded-lg bg-gray-100 cursor-not-allowed"
          />
        </div>
        <div class="mb-4">
          <label class="block text-gray-600 mb-1">Amount</label>
          <input
            id="amount"
            type="text"
            value="120.00"
            readonly
            class="w-full px-4 py-2 border rounded-lg bg-gray-100 cursor-not-allowed"
          />
        </div>

        Card Payment
        <div id="form-card" class="space-y-4">
          <div>
            <label class="block text-gray-600 mb-1">Card Number</label>
            <input
              id="card-number"
              type="text"
              placeholder="1234 5678 9012 3456"
              class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500"
            />
          </div>
          <div class="flex gap-4">
            <div class="flex-1">
              <label class="block text-gray-600 mb-1">Expiry</label>
              <input
                id="expiry"
                type="text"
                placeholder="MM/YY"
                class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500"
              />
            </div>
            <div class="flex-1">
              <label class="block text-gray-600 mb-1">CVV</label>
              <input
                id="cvv"
                type="text"
                placeholder="123"
                class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500"
              />
            </div>
          </div>
          <button
            id="pay-now"
            class="w-full mt-6 bg-blue-600 text-white py-3 rounded-lg font-semibold hover:bg-blue-700 transition"
          >
            Pay Now
          </button>
        </div>

        Transfer Payment
        <div id="form-transfer" class="space-y-4 hidden">
          <div>
            <label class="block text-gray-600 mb-1">Account Number</label>
            <input
              id="account-number"
              type="text"
              placeholder="0123456789"
              class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500"
            />
          </div>
          <div>
            <label class="block text-gray-600 mb-1">Bank Name</label>
            <input
              id="bank-name"
              type="text"
              placeholder="Access Bank"
              class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500"
            />
          </div>
          <button
            id="transfer_id"
            type="submit"
            class="bg-green-500 text-white px-4 py-2 rounded w-full"
          >
            Make Transfer
          </button>
        </div>

        Wallet Payment
        <div id="form-wallet" class="space-y-4 hidden">
          <div>
            <label class="block text-gray-600 mb-1">Wallet ID / Email</label>
            <input
              id="wallet-id"
              type="text"
              placeholder="wallet@example.com"
              class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500"
            />
            <button
              id="wallet-btn"
              type="submit"
              class="bg-purple-500 text-white px-4 py-2 rounded w-full"
            >
              Pay from Wallet
            </button>
          </div>
        </div>
      </div>
    </div>
   <script>
document.addEventListener("DOMContentLoaded", () => {
  Populate email & amount from localStorage/URL
  let user = JSON.parse(localStorage.getItem("user"));
  if (!user) {
    window.location.href = "index.html";
    return;
  }
  document.getElementById("email").value = user.email;

  let urlParams = new URLSearchParams(window.location.search);
  let amount = urlParams.get("amount") || 0;
  document.getElementById("amount").value = amount;

  Tab handling
  const tabs = {
    card: document.getElementById("tab-card"),
    transfer: document.getElementById("tab-transfer"),
    wallet: document.getElementById("tab-wallet"),
  };
  const forms = {
    card: document.getElementById("form-card"),
    transfer: document.getElementById("form-transfer"),
    wallet: document.getElementById("form-wallet"),
  };

  function showForm(method) {
    Hide all forms
    Object.values(forms).forEach((f) => f.classList.add("hidden"));
    forms[method].classList.remove("hidden");

    Reset all tabs to default style
    Object.values(tabs).forEach((tab) => {
      tab.classList.remove("bg-green-500", "text-white");
      tab.classList.add("bg-gray-200", "text-gray-700", "hover:bg-gray-300");
    });

    Highlight the active tab
    tabs[method].classList.remove("bg-gray-200", "text-gray-700", "hover:bg-gray-300");
    tabs[method].classList.add("bg-green-500", "text-white");
  }

  tabs.card.addEventListener("click", () => showForm("card"));
  tabs.transfer.addEventListener("click", () => showForm("transfer"));
  tabs.wallet.addEventListener("click", () => showForm("wallet"));
  showForm("card"); // default

  Card Number formatting ‚Äî dash every 4 digits
  const cardNumber = document.getElementById("card-number");
  cardNumber.addEventListener("input", () => {
    let value = cardNumber.value.replace(/\D/g, "").slice(0, 16);
    cardNumber.value = value.match(/.{1,4}/g)?.join("-") || value;
  });

  Expiry date formatting and validation
  const expiry = document.getElementById("expiry");
  expiry.addEventListener("input", () => {
    let val = expiry.value.replace(/\D/g, "").slice(0, 4);
    if (val.length > 2) {
      val = val.slice(0, 2) + "/" + val.slice(2);
    }
    expiry.value = val;
  });

  function isCardExpired(exp) {
    const [mm, yy] = exp.split("/").map((v) => parseInt(v, 10));
    if (!mm || !yy || mm < 1 || mm > 12) return true;

    const now = new Date();
    const currentMonth = now.getMonth() + 1;
    const currentYear = now.getFullYear() % 100;

    return yy < currentYear || (yy === currentYear && mm < currentMonth);
  }

  CVV restriction
  const cvv = document.getElementById("cvv");
  cvv.addEventListener("input", () => {
    cvv.value = cvv.value.replace(/\D/g, "").slice(0, 3);
  });

  Payment request
  async function makePayment(payload) {
    try {
      const res = await fetch("http://127.0.0.1:8000/api/v1/make_payment", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(payload),
      });
      const data = await res.json();
      if (res.ok) {
        alert(data.message || "Payment processed successfully!");
      } else {
        alert("Error: " + (data.detail || "Something went wrong"));
      }
    } catch (err) {
      console.error(err);
      alert("Payment failed.");
    }
  }

  Handlers
  document.getElementById("pay-now").addEventListener("click", () => {
    if (isCardExpired(expiry.value)) {
      alert("Card is expired.");
      return;
    }

    const payload = {
      method: "card",
      amount: parseFloat(document.getElementById("amount").value),
      currency: "NGN",
      card_number: cardNumber.value.replace(/-/g, ""), 
      expiry: expiry.value,
      cvv: cvv.value,
    };
    makePayment(payload);
  });

  document.getElementById("transfer_id").addEventListener("click", () => {
    const payload = {
      method: "transfer",
      amount: parseFloat(document.getElementById("amount").value),
      currency: "NGN",
      account_number: document.getElementById("account-number").value,
    };
    makePayment(payload);
  });

  document.getElementById("wallet-btn").addEventListener("click", () => {
    const payload = {
      method: "wallet",
      amount: parseFloat(document.getElementById("amount").value),
      currency: "NGN",
      wallet_id: document.getElementById("wallet-id").value,
    };
    makePayment(payload);
  });
});
</script>


    <script src="https://cdn.tailwindcss.com"></script>
  </body>
</html> -->
